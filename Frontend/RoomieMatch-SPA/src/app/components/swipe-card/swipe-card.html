<div class="card" [ngClass]="{'swiping-left': swipeDirection === 'left', 'swiping-right': swipeDirection === 'right'}">

    <!-- ROOM CARD: For HAS_ROOM users (Rumly-style with avatar overlay) -->
    <ng-container *ngIf="user.userType === 'HAS_ROOM'">
        <div class="card-image"
            [style.background-image]="(user.room?.roomImage ? 'url(' + user.room?.roomImage + ')' : null)"
            [class.has-image]="user.room?.roomImage">
            <span *ngIf="!user.room?.roomImage" class="no-room-image">ğŸ </span>

            <!-- Avatar overlay on image -->
            <div class="avatar-overlay">
                <div class="avatar-circle"
                    [style.background-image]="user.profileImage ? 'url(' + user.profileImage + ')' : null"
                    [class.has-image]="user.profileImage">
                    <span *ngIf="!user.profileImage">{{ user.firstName[0] }}</span>
                </div>
                <span class="avatar-name">{{ user.firstName }}</span>
            </div>
        </div>
        <div class="card-content room-content">
            <!-- Room Title -->
            <h3 class="room-title-main">{{ user.room?.title || 'Room Available' }}</h3>

            <!-- Room Details Row -->
            <p class="room-meta-row">
                <span *ngIf="user.room?.availableFrom">{{ user.room?.availableFrom | date:'d MMM yy' }}</span>
                <span *ngIf="user.room?.sizeSqm"> Â· {{ user.room?.sizeSqm }} mÂ²</span>
                <span *ngIf="user.room?.location"> Â· {{ user.room?.location }}</span>
            </p>

            <!-- Price -->
            <p class="room-price">{{ user.room?.rent | currency:'DKK':'symbol':'1.0-0' }}/mo</p>

            <!-- Description -->
            <p class="room-description">{{ user.room?.description || user.bio || 'Room for rent in shared apartment' }}
            </p>
        </div>
    </ng-container>

    <!-- PERSON CARD: For NEEDS_ROOM users (no room, just person info) -->
    <ng-container *ngIf="user.userType === 'NEEDS_ROOM'">
        <div class="card-image person-card-image"
            [style.background-image]="user.profileImage ? 'url(' + user.profileImage + ')' : null"
            [class.has-image]="user.profileImage">
            <span *ngIf="!user.profileImage" class="avatar-initial">{{ user.firstName[0] }}</span>
        </div>
        <div class="card-content person-content">
            <div class="header">
                <div class="user-info">
                    <h3 class="name">{{ user.firstName }}, <span class="age">{{ user.age }}</span></h3>
                    <p class="user-gender" *ngIf="user.gender">{{ user.gender }}</p>
                </div>
            </div>

            <div class="person-details">
                <p class="bio">{{ user.bio || 'No bio provided.' }}</p>
            </div>
        </div>
    </ng-container>

    <!-- Action buttons (same for both) -->
    <div class="actions">
        <button class="btn-action btn-pass" (click)="onPass($event)">
            <span>âœ•</span>
        </button>
        <button class="btn-action btn-like" (click)="onLike($event)">
            <span>â™¥</span>
        </button>
    </div>
</div>