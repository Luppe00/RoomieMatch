<div class="user-list-container">
    <div *ngIf="!currentUser" class="hero-section">
        <div class="hero-content">
            <div class="hero-badge">üè† Find Your Perfect Roommate</div>
            <h1 class="hero-title">
                Where <span class="gradient-text">Roommates</span>
                <br>Find Their Match
            </h1>
            <p class="hero-subtitle">
                Swipe, match, and connect with compatible roommates in your city.
                Whether you have a room to share or need one, we've got you covered.
            </p>
            <div class="hero-buttons">
                <a routerLink="/register" class="btn-hero-primary">Get Started Free</a>
                <a routerLink="/login" class="btn-hero-secondary">I Have an Account</a>
            </div>
            <div class="hero-stats">
                <div class="stat">
                    <span class="stat-number">10K+</span>
                    <span class="stat-label">Active Users</span>
                </div>
                <div class="stat">
                    <span class="stat-number">5K+</span>
                    <span class="stat-label">Matches Made</span>
                </div>
                <div class="stat">
                    <span class="stat-number">98%</span>
                    <span class="stat-label">Satisfaction</span>
                </div>
            </div>
        </div>
        <div class="hero-visual">
            <div class="floating-card card-1">
                <div class="mini-avatar">üë®</div>
                <div class="mini-info">
                    <span class="mini-name">Alex, 24</span>
                    <span class="mini-badge has">Has Room</span>
                </div>
            </div>
            <div class="floating-card card-2">
                <div class="mini-avatar">üë©</div>
                <div class="mini-info">
                    <span class="mini-name">Sarah, 22</span>
                    <span class="mini-badge needs">Needs Room</span>
                </div>
            </div>
            <div class="match-heart">üíï</div>
        </div>

        <!-- How It Works Section -->
        <div class="how-it-works">
            <h2 class="section-title">How It Works</h2>
            <div class="steps">
                <div class="step">
                    <div class="step-icon">üìù</div>
                    <h3>1. Create Profile</h3>
                    <p>Sign up and tell us about yourself and what you're looking for</p>
                </div>
                <div class="step">
                    <div class="step-icon">üëÜ</div>
                    <h3>2. Swipe & Match</h3>
                    <p>Browse profiles. Swipe right to like, left to pass</p>
                </div>
                <div class="step">
                    <div class="step-icon">üí¨</div>
                    <h3>3. Connect</h3>
                    <p>When you both like each other, start chatting instantly!</p>
                </div>
            </div>
        </div>
    </div>

    <div *ngIf="currentUser" class="explore-section">
        <!-- Explore Header -->
        <div class="explore-header">
            <div class="explore-title">
                <h1>Discover</h1>
                <p>Swipe right to like, left to pass</p>
            </div>
            <div class="explore-counter" *ngIf="potentialMatches.length > 0">
                {{ currentIndex + 1 }} / {{ potentialMatches.length }}
            </div>
        </div>

        <div *ngIf="loading" class="loading">Loading potential roomies...</div>

        <div *ngIf="!loading && currentUserCard" class="card-stack" (click)="openDetailModal(currentUserCard)">
            <app-swipe-card [user]="currentUserCard" (liked)="onLike()" (passed)="onPass()">
            </app-swipe-card>
            <div class="tap-hint">
                <span class="tap-icon">üëÜ</span>
                <span>Tap card for details</span>
            </div>
        </div>

        <div *ngIf="!loading && !currentUserCard" class="empty-state">
            <div class="empty-icon">üëÄ</div>
            <h2>No more potential matches</h2>
            <p>You've seen everyone in your area for now.</p>
            <div class="empty-actions">
                <button class="btn-refresh" (click)="loadUsers()">Check Again</button>
            </div>
        </div>
    </div>

    <div class="match-overlay" *ngIf="matchMessage">
        <div class="match-content">
            {{ matchMessage }}
            <div style="font-size: 3rem; margin: 1rem 0;">üéâ</div>
            <button (click)="closeMatch()" class="btn-primary" style="font-size: 1rem; padding: 0.5rem 1.5rem;">Keep
                Swiping</button>
        </div>
    </div>

    <!-- Room Detail Modal -->
    <div class="detail-modal-overlay" *ngIf="showDetailModal && selectedUser" (click)="closeDetailModal()">
        <div class="detail-modal" (click)="$event.stopPropagation()">
            <!-- Close Button -->
            <button class="modal-close" (click)="closeDetailModal()">√ó</button>

            <!-- Hero Image with Gallery Navigation -->
            <div class="modal-hero" (click)="openLightbox(modalPhotoIndex)">
                <img *ngIf="getCurrentModalPhoto()" [src]="getCurrentModalPhoto()" alt="Room photo">
                <div *ngIf="!getCurrentModalPhoto()" class="no-image-placeholder">
                    <span>üì∑</span>
                    <span>No photos yet</span>
                </div>

                <!-- Photo Navigation Arrows -->
                <button class="gallery-nav gallery-prev" *ngIf="getModalPhotos().length > 1"
                    (click)="prevModalPhoto($event)">
                    ‚Äπ
                </button>
                <button class="gallery-nav gallery-next" *ngIf="getModalPhotos().length > 1"
                    (click)="nextModalPhoto($event)">
                    ‚Ä∫
                </button>

                <!-- Photo Counter -->
                <div class="photo-counter" *ngIf="getModalPhotos().length > 1">
                    {{ modalPhotoIndex + 1 }} / {{ getModalPhotos().length }}
                </div>

                <div class="image-hint" *ngIf="getCurrentModalPhoto()">Click to enlarge</div>
            </div>

            <div class="modal-body">
                <!-- Left Column: Details -->
                <div class="modal-main">
                    <h1 class="room-title">üìç {{ selectedUser.room?.location || 'Location not specified' }}</h1>
                    <p class="room-subtitle" *ngIf="selectedUser.room?.title">{{ selectedUser.room?.title }}</p>
                    <p class="address-note">üîí Full address revealed after matching</p>

                    <div class="room-meta">
                        <div class="meta-item" *ngIf="selectedUser.room?.sizeSqm">
                            <span class="meta-value">{{ selectedUser.room?.sizeSqm }} m¬≤</span>
                            <span class="meta-label">Size</span>
                        </div>
                        <div class="meta-item">
                            <span class="meta-value">{{ selectedUser.room?.rent | currency:'DKK':'symbol':'1.0-0'
                                }}/mo</span>
                            <span class="meta-label">Rent</span>
                        </div>
                        <div class="meta-item" *ngIf="selectedUser.room?.availableFrom">
                            <span class="meta-value">{{ selectedUser.room?.availableFrom | date:'mediumDate' }}</span>
                            <span class="meta-label">Available</span>
                        </div>
                    </div>

                    <div class="section">
                        <h3>About the Room</h3>
                        <p class="description">{{ selectedUser.room?.description || 'No description provided.' }}</p>
                    </div>

                    <div class="section">
                        <h3>About the Renter</h3>
                        <div class="renter-info">
                            <div class="renter-avatar">
                                <img *ngIf="selectedUser.profileImage" [src]="selectedUser.profileImage" alt="Profile">
                                <span *ngIf="!selectedUser.profileImage">{{ selectedUser.firstName?.charAt(0) }}{{
                                    selectedUser.lastName?.charAt(0) }}</span>
                            </div>
                            <div class="renter-details">
                                <span class="renter-name">{{ selectedUser.firstName }} {{ selectedUser.lastName }}, {{
                                    selectedUser.age }}</span>
                                <span class="renter-gender">{{ selectedUser.gender }}</span>
                            </div>
                        </div>
                        <p class="renter-bio">{{ selectedUser.bio || 'No bio provided.' }}</p>
                    </div>
                </div>

                <!-- Right Column: Action Card -->
                <div class="modal-sidebar">
                    <div class="action-card">
                        <div class="price-tag">
                            <span class="price">{{ selectedUser.room?.rent | currency:'DKK':'symbol':'1.0-0' }}</span>
                            <span class="price-period">per month</span>
                        </div>
                        <div class="action-buttons">
                            <button class="btn-pass" (click)="passFromModal()">‚úï Pass</button>
                            <button class="btn-like" (click)="likeFromModal()">‚ô• Like</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Lightbox -->
    <div class="lightbox-overlay" *ngIf="showLightbox && selectedUser?.room?.roomImage" (click)="closeLightbox($event)">
        <button class="lightbox-close" (click)="closeLightbox($event)">√ó</button>
        <img [src]="selectedUser?.room?.roomImage" alt="Room photo full">
    </div>
</div>