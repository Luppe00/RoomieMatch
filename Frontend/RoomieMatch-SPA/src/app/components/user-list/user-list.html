<div class="user-list-container">
    <div *ngIf="!currentUser" class="landing-page">
        <!-- Dark Hero Section -->
        <section class="hero-dark">
            <div class="hero-inner">
                <div class="hero-content">
                    <h1 class="hero-title-large">
                        {{ t('landing.title') }}<br><span class="text-coral">{{ t('landing.titleHighlight') }}</span>
                    </h1>
                    <p class="hero-description">
                        {{ t('landing.description') }}
                    </p>
                    <a routerLink="/register" class="btn-cta">
                        {{ t('landing.cta') }}
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M5 12h14M12 5l7 7-7 7" />
                        </svg>
                    </a>
                    <div class="hero-features">
                        <div class="hero-feature">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <polyline points="20 6 9 17 4 12"></polyline>
                            </svg>
                            <span>{{ t('landing.feature1') }}</span>
                        </div>
                        <div class="hero-feature">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <polyline points="20 6 9 17 4 12"></polyline>
                            </svg>
                            <span>{{ t('landing.feature2') }}</span>
                        </div>
                        <div class="hero-feature">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <polyline points="20 6 9 17 4 12"></polyline>
                            </svg>
                            <span>{{ t('landing.feature3') }}</span>
                        </div>
                    </div>
                </div>
                <div class="hero-phone">
                    <div class="phone-mockup">
                        <div class="phone-screen">
                            <div class="phone-header">
                                <span class="phone-logo">RoomieMatch</span>
                            </div>
                            <div class="phone-card">
                                <div class="card-image">
                                    <img src="https://images.unsplash.com/photo-1522708323590-d24dbb6b0267?w=400&h=300&fit=crop"
                                        alt="Cozy room">
                                </div>
                                <div class="card-info">
                                    <div class="card-location">√òsterbro</div>
                                    <div class="card-price">8.500 kr./md</div>
                                </div>
                                <div class="card-title">Bright room with balcony</div>
                                <div class="card-actions">
                                    <div class="action-btn pass">‚úï</div>
                                    <div class="action-btn like">‚ô•</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section class="stats-bar">
            <div class="stats-inner">
                <div class="stat-item">
                    <span class="stat-number-large">+2,500</span>
                    <span class="stat-text">{{ t('landing.stat1') }}</span>
                </div>
                <div class="stat-item">
                    <span class="stat-number-large">+150</span>
                    <span class="stat-text">{{ t('landing.stat2') }}</span>
                </div>
                <div class="stat-item">
                    <span class="stat-number-large">+10,000</span>
                    <span class="stat-text">{{ t('landing.stat3') }}</span>
                </div>
            </div>
        </section>

        <!-- How It Works Section -->
        <section class="how-section">
            <h2 class="section-heading">{{ t('landing.howTitle') }}</h2>
            <p class="section-subheading">{{ t('landing.howSubtitle') }}</p>
            <div class="steps-grid">
                <div class="step-card">
                    <div class="step-number">01</div>
                    <h3>{{ t('landing.step1Title') }}</h3>
                    <p>{{ t('landing.step1Desc') }}</p>
                </div>
                <div class="step-card">
                    <div class="step-number">02</div>
                    <h3>{{ t('landing.step2Title') }}</h3>
                    <p>{{ t('landing.step2Desc') }}</p>
                </div>
                <div class="step-card">
                    <div class="step-number">03</div>
                    <h3>{{ t('landing.step3Title') }}</h3>
                    <p>{{ t('landing.step3Desc') }}</p>
                </div>
            </div>
        </section>

        <footer class="landing-footer">
            <div class="footer-main">
                <div class="footer-col footer-brand-col">
                    <h4>RoomieMatch ApS</h4>
                    <p>Copenhagen, Denmark</p>
                    <p>CVR: 12345678</p>
                    <p class="footer-tagline">{{ t('footer.tagline') }}</p>
                </div>

                <div class="footer-col">
                    <h4>{{ t('footer.information') }}</h4>
                    <a href="#">{{ t('footer.terms') }}</a>
                    <a href="#">{{ t('footer.cookies') }}</a>
                    <a href="#">{{ t('footer.privacy') }}</a>
                    <a href="#">{{ t('footer.faq') }}</a>
                    <a href="#">{{ t('footer.contact') }}</a>
                </div>

                <div class="footer-col">
                    <h4>{{ t('footer.navigation') }}</h4>
                    <a href="#">{{ t('footer.home') }}</a>
                    <a href="#">{{ t('footer.searchRoom') }}</a>
                    <a href="#">{{ t('footer.searchRoommate') }}</a>
                    <a routerLink="/login">{{ t('nav.login') }}</a>
                    <a routerLink="/register">{{ t('nav.register') }}</a>
                </div>

                <div class="footer-col">
                    <h4>{{ t('footer.followUs') }}</h4>
                    <div class="social-links">
                        <a href="#" class="social-icon" aria-label="Facebook">
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24"
                                fill="currentColor">
                                <path d="M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z" />
                            </svg>
                        </a>
                        <a href="#" class="social-icon" aria-label="Instagram">
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24"
                                fill="none" stroke="currentColor" stroke-width="2">
                                <rect x="2" y="2" width="20" height="20" rx="5" ry="5" />
                                <path d="M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z" />
                                <line x1="17.5" y1="6.5" x2="17.51" y2="6.5" />
                            </svg>
                        </a>
                        <a href="#" class="social-icon" aria-label="LinkedIn">
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24"
                                fill="currentColor">
                                <path
                                    d="M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z" />
                                <rect x="2" y="9" width="4" height="12" />
                                <circle cx="4" cy="4" r="2" />
                            </svg>
                        </a>
                    </div>
                </div>
            </div>

            <div class="footer-bottom">
                <p>{{ t('footer.copyright') }}</p>
            </div>
        </footer>
    </div>

    <div *ngIf="currentUser" class="explore-section">
        <!-- Explore Header -->
        <div class="explore-header">
            <div class="explore-title">
                <h1>{{ t('explore.title') }}</h1>
                <p>{{ t('explore.subtitle') }}</p>
            </div>
        </div>

        <div *ngIf="loading" class="loading">{{ t('explore.loading') }}</div>

        <div *ngIf="!loading && currentUserCard" class="card-stack" (click)="openDetailModal(currentUserCard)">
            <app-swipe-card [user]="currentUserCard" (liked)="onLike()" (passed)="onPass()">
            </app-swipe-card>
            <div class="tap-hint">
                <span class="tap-icon">üëÜ</span>
                <span>{{ t('explore.tapDetails') }}</span>
            </div>
        </div>

        <div *ngIf="!loading && !currentUserCard" class="empty-state">
            <div class="empty-icon">üëÄ</div>
            <h2>{{ t('explore.noMore') }}</h2>
            <p>{{ t('explore.checkBack') }}</p>
            <div class="empty-actions">
                <button class="btn-refresh" (click)="loadUsers()">{{ t('common.retry') }}</button>
            </div>
        </div>
    </div>

    <div class="match-overlay" *ngIf="matchMessage">
        <div class="match-content">
            {{ matchMessage }}
            <div style="font-size: 3rem; margin: 1rem 0;">üéâ</div>
            <button (click)="closeMatch()" class="btn-primary" style="font-size: 1rem; padding: 0.5rem 1.5rem;">Keep
                Swiping</button>
        </div>
    </div>

    <!-- Room Detail Modal -->
    <div class="detail-modal-overlay" *ngIf="showDetailModal && selectedUser" (click)="closeDetailModal()">
        <div class="detail-modal" (click)="$event.stopPropagation()">
            <!-- Close Button -->
            <button class="modal-close" (click)="closeDetailModal()">√ó</button>

            <!-- Hero Image with Gallery Navigation -->
            <div class="modal-hero" (click)="openLightbox(modalPhotoIndex)">
                <img *ngIf="getCurrentModalPhoto()" [src]="getCurrentModalPhoto()" alt="Room photo">
                <div *ngIf="!getCurrentModalPhoto()" class="no-image-placeholder">
                    <span>üì∑</span>
                    <span>No photos yet</span>
                </div>

                <!-- Photo Navigation Arrows -->
                <button class="gallery-nav gallery-prev" *ngIf="getModalPhotos().length > 1"
                    (click)="prevModalPhoto($event)">
                    ‚Äπ
                </button>
                <button class="gallery-nav gallery-next" *ngIf="getModalPhotos().length > 1"
                    (click)="nextModalPhoto($event)">
                    ‚Ä∫
                </button>

                <!-- Photo Counter -->
                <div class="photo-counter" *ngIf="getModalPhotos().length > 1">
                    {{ modalPhotoIndex + 1 }} / {{ getModalPhotos().length }}
                </div>

                <div class="image-hint" *ngIf="getCurrentModalPhoto()">Click to enlarge</div>
            </div>

            <div class="modal-body">
                <!-- Left Column: Details -->
                <div class="modal-main">
                    <!-- FOR HAS_ROOM USERS: Show Room Details -->
                    <ng-container *ngIf="selectedUser.userType === 'HAS_ROOM'">
                        <h1 class="room-title">üìç {{ selectedUser.room?.location || 'Location not specified' }}</h1>
                        <p class="room-subtitle" *ngIf="selectedUser.room?.title">{{ selectedUser.room?.title }}</p>
                        <p class="address-note">üîí Full address revealed after matching</p>

                        <div class="room-meta">
                            <div class="meta-item" *ngIf="selectedUser.room?.sizeSqm">
                                <span class="meta-value">{{ selectedUser.room?.sizeSqm }} m¬≤</span>
                                <span class="meta-label">Size</span>
                            </div>
                            <div class="meta-item">
                                <span class="meta-value">{{ selectedUser.room?.rent | currency:'DKK':'symbol':'1.0-0'
                                    }}/mo</span>
                                <span class="meta-label">Rent</span>
                            </div>
                            <div class="meta-item" *ngIf="selectedUser.room?.availableFrom">
                                <span class="meta-value">{{ selectedUser.room?.availableFrom | date:'mediumDate'
                                    }}</span>
                                <span class="meta-label">Available</span>
                            </div>
                        </div>

                        <div class="section">
                            <h3>About the Room</h3>
                            <p class="description">{{ selectedUser.room?.description || 'No description provided.' }}
                            </p>
                        </div>

                        <div class="section">
                            <h3>About the Renter</h3>
                            <div class="renter-info">
                                <div class="renter-avatar">
                                    <img *ngIf="selectedUser.profileImage" [src]="selectedUser.profileImage"
                                        alt="Profile">
                                    <span *ngIf="!selectedUser.profileImage">{{ selectedUser.firstName?.charAt(0) }}{{
                                        selectedUser.lastName?.charAt(0) }}</span>
                                </div>
                                <div class="renter-details">
                                    <span class="renter-name">{{ selectedUser.firstName }} {{ selectedUser.lastName }},
                                        {{ selectedUser.age }}</span>
                                    <span class="renter-gender">{{ selectedUser.gender }}</span>
                                </div>
                            </div>
                            <p class="renter-bio">{{ selectedUser.bio || 'No bio provided.' }}</p>
                        </div>
                    </ng-container>

                    <!-- FOR NEEDS_ROOM USERS: Show Person Details -->
                    <ng-container *ngIf="selectedUser.userType === 'NEEDS_ROOM'">
                        <h1 class="person-title">{{ selectedUser.firstName }} {{ selectedUser.lastName }}, {{
                            selectedUser.age }}</h1>
                        <p class="person-subtitle" *ngIf="selectedUser.gender">
                            {{ selectedUser.gender }}
                        </p>

                        <div class="section">
                            <h3>About Me</h3>
                            <p class="description">{{ selectedUser.bio || 'No bio provided yet.' }}</p>
                        </div>

                        <div class="section">
                            <h3>What I'm Looking For</h3>
                            <div class="preference-list">
                                <div class="pref-row">
                                    <span class="pref-icon">üè†</span>
                                    <span>Looking for a shared living situation</span>
                                </div>
                                <div class="pref-row">
                                    <span class="pref-icon">ü§ù</span>
                                    <span>Open to connecting with compatible roommates</span>
                                </div>
                                <div class="pref-row">
                                    <span class="pref-icon">üí¨</span>
                                    <span>Contact info shared after matching</span>
                                </div>
                            </div>
                        </div>
                    </ng-container>
                </div>

                <!-- Right Column: Action Card -->
                <div class="modal-sidebar">
                    <div class="action-card">
                        <!-- Show price for HAS_ROOM -->
                        <div class="price-tag" *ngIf="selectedUser.userType === 'HAS_ROOM'">
                            <span class="price">{{ selectedUser.room?.rent | currency:'DKK':'symbol':'1.0-0' }}</span>
                            <span class="price-period">per month</span>
                        </div>
                        <!-- Show person card for NEEDS_ROOM -->
                        <div class="person-card-mini" *ngIf="selectedUser.userType === 'NEEDS_ROOM'">
                            <div class="person-avatar-mini">
                                <img *ngIf="selectedUser.profileImage" [src]="selectedUser.profileImage" alt="Profile">
                                <span *ngIf="!selectedUser.profileImage">{{ selectedUser.firstName?.charAt(0) }}</span>
                            </div>
                            <span class="person-name-mini">{{ selectedUser.firstName }}</span>
                        </div>
                        <div class="action-buttons">
                            <button class="btn-pass" (click)="passFromModal()">‚úï Pass</button>
                            <button class="btn-like" (click)="likeFromModal()">‚ô• Like</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Lightbox -->
    <div class="lightbox-overlay" *ngIf="showLightbox && selectedUser?.room?.roomImage" (click)="closeLightbox($event)">
        <button class="lightbox-close" (click)="closeLightbox($event)">√ó</button>
        <img [src]="selectedUser?.room?.roomImage" alt="Room photo full">
    </div>
</div>